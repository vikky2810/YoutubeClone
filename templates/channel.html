{% extends 'base.html' %}

{% block description %}{{ channel_name }} - ViewTube{% endblock %}
{% block title %}{{ channel_name }} - ViewTube{% endblock %}

{% block header_search %}
<form action="/search" method="get" class="yt-search-form" id="yt-search-form" role="search">
    <div class="yt-search-wrapper">
        <div class="yt-search-box">
            <input type="text" name="q" class="yt-search-input" id="main-search-input" placeholder="Search"
                autocomplete="off" aria-label="Search">
            <button type="submit" class="yt-search-btn" aria-label="Search">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                    <path
                        d="M20.87 20.17l-5.59-5.59C16.35 13.35 17 11.75 17 10c0-3.87-3.13-7-7-7s-7 3.13-7 7 3.13 7 7 7c1.75 0 3.35-.65 4.58-1.71l5.59 5.59.7-.71zM10 16c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z" />
                </svg>
            </button>
        </div>
        <button type="button" class="yt-mic-btn" aria-label="Search with voice">
            <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor">
                <path
                    d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z" />
            </svg>
        </button>
    </div>
</form>
{% endblock %}

{% block content %}
<!-- Channel Banner -->
<div class="yt-channel-banner"></div>

<!-- Channel Header -->
<div class="yt-channel-header yt-page-container">
    <div class="yt-channel-header-inner">
        <div class="yt-channel-avatar-xl">
            {% if channel_thumbnail %}
            <img src="{{ channel_thumbnail }}" alt="{{ channel_name }}">
            {% else %}
            <span>{{ channel_name[0]|upper }}</span>
            {% endif %}
        </div>
        <div class="yt-channel-header-info">
            <h1 class="yt-channel-name-xl">{{ channel_name }}</h1>
            <div class="yt-channel-meta-row">
                <span class="yt-channel-handle">@{{ channel_name|lower|replace(' ', '') }}</span>
                <span class="yt-channel-stat">{{ videos|length }} videos</span>
            </div>
        </div>
        <div class="yt-channel-header-actions">
            <button class="yt-subscribe-btn" id="channel-subscribe-btn">Subscribe</button>
        </div>
    </div>

    <!-- Channel Tabs -->
    <nav class="yt-channel-tabs" aria-label="Channel sections">
        <button class="yt-channel-tab active">Videos</button>
        <button class="yt-channel-tab">Shorts</button>
        <button class="yt-channel-tab">Playlists</button>
        <button class="yt-channel-tab">About</button>
    </nav>
</div>

<!-- Channel Videos Grid -->
<div class="yt-page-container">
    {% if videos %}
    <div class="yt-video-grid">
        {% for video in videos %}
        <article class="yt-video-card" tabindex="0">
            <a href="/watch?v={{ video.id }}" class="yt-video-card-link" aria-label="{{ video.title }}">
                <div class="yt-thumbnail-wrapper">
                    <img src="{{ video.thumbnail }}" alt="{{ video.title }}" class="yt-thumbnail" loading="lazy">
                    {% if video.duration %}
                    <span class="yt-duration">{{ video.duration }}</span>
                    {% endif %}
                    <div class="yt-thumbnail-overlay">
                        <svg class="yt-play-icon" viewBox="0 0 24 24" width="48" height="48" fill="white">
                            <path d="M8 5v14l11-7z" />
                        </svg>
                    </div>
                </div>
                <div class="yt-video-card-info">
                    <div class="yt-video-card-text" style="padding-left: 0; flex: 1;">
                        <h3 class="yt-video-card-title" title="{{ video.title }}">{{ video.title }}</h3>
                        <p class="yt-video-card-meta">{{ video.view_count }}{% if video.upload_date %} • {{
                            video.upload_date }}{% endif %}</p>
                    </div>
                    <button class="yt-card-options-btn" aria-label="More options" onclick="event.preventDefault();">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path
                                d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" />
                        </svg>
                    </button>
                </div>
            </a>
        </article>
        {% endfor %}
    </div>
    {% else %}
    <div class="yt-no-results">
        <svg viewBox="0 0 24 24" width="64" height="64" fill="#aaa">
            <path
                d="M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5v2h8v-2h5c1.1 0 1.99-.9 1.99-2L23 5c0-1.1-.9-2-2-2zm0 14H3V5h18v12z" />
        </svg>
        <h2>No videos found for this channel</h2>
        <p>The channel might not have any public videos or the ID is incorrect.</p>
        <a href="/" class="yt-btn-secondary">← Back to Home</a>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script>
    // Channel tabs
    const tabs = document.querySelectorAll('.yt-channel-tab');
    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
        });
    });

    // Subscribe button
    const subBtn = document.getElementById('channel-subscribe-btn');
    if (subBtn) {
        subBtn.addEventListener('click', () => {
            subBtn.classList.toggle('subscribed');
            subBtn.textContent = subBtn.classList.contains('subscribed') ? 'Subscribed' : 'Subscribe';
        });
    }
</script>
{% endblock %}